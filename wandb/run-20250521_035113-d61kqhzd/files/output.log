0 - 2025-05-21 03:51:16,100 loader.py[line:132] INFO dataset augmentation: default, resize: 32
0 - 2025-05-21 03:51:17,386 loader.py[line:163] INFO /root/FedFed
0 - 2025-05-21 03:51:17,389 loader.py[line:279] INFO partition_method = hetero
0 - 2025-05-21 03:51:17,389 loader.py[line:291] INFO N = 50000
0 - 2025-05-21 03:51:17,398 loader.py[line:223] INFO train_cls_local_counts_dict = {0: {0: 976, 1: 1632, 2: 18, 3: 1120, 5: 132, 7: 636, 8: 3101}, 1: {1: 1, 5: 59, 7: 3, 8: 851, 9: 4228}, 2: {1: 814, 2: 212, 3: 3735, 5: 2737}, 3: {0: 46, 1: 291, 3: 4, 8: 401, 9: 123}, 4: {0: 125, 2: 1, 3: 137, 4: 1476, 6: 303, 8: 642, 9: 47}, 5: {0: 1923, 1: 381, 2: 3826}, 6: {1: 334, 2: 3, 3: 3, 4: 2477, 5: 2055, 7: 1543}, 7: {0: 6, 1: 1546, 2: 881, 7: 591, 8: 4, 9: 6}, 8: {0: 435, 2: 58, 4: 1046, 5: 16, 6: 4536}, 9: {0: 1489, 1: 1, 2: 1, 3: 1, 4: 1, 5: 1, 6: 161, 7: 2227, 8: 1, 9: 596}}
0 - 2025-05-21 03:51:17,398 loader.py[line:193] INFO shuffle: True, drop_last:False, train_sampler:None
0 - 2025-05-21 03:51:17,399 loader.py[line:228] INFO train_dl_global number = 782
0 - 2025-05-21 03:51:17,399 loader.py[line:229] INFO test_dl_global number = 157
0 - 2025-05-21 03:51:17,407 loader.py[line:246] INFO client_ID = 0, local_train_sample_number = 7615, local_test_sample_number = 10000
0 - 2025-05-21 03:51:17,407 loader.py[line:193] INFO shuffle: True, drop_last:False, train_sampler:None
0 - 2025-05-21 03:51:17,407 loader.py[line:253] INFO client_index = 0, batch_num_train_local = 119, batch_num_test_local = 157
0 - 2025-05-21 03:51:17,413 loader.py[line:246] INFO client_ID = 1, local_train_sample_number = 5142, local_test_sample_number = 10000
0 - 2025-05-21 03:51:17,413 loader.py[line:193] INFO shuffle: True, drop_last:False, train_sampler:None
0 - 2025-05-21 03:51:17,413 loader.py[line:253] INFO client_index = 1, batch_num_train_local = 81, batch_num_test_local = 157
0 - 2025-05-21 03:51:17,421 loader.py[line:246] INFO client_ID = 2, local_train_sample_number = 7498, local_test_sample_number = 10000
0 - 2025-05-21 03:51:17,421 loader.py[line:193] INFO shuffle: True, drop_last:False, train_sampler:None
0 - 2025-05-21 03:51:17,421 loader.py[line:253] INFO client_index = 2, batch_num_train_local = 118, batch_num_test_local = 157
0 - 2025-05-21 03:51:17,424 loader.py[line:246] INFO client_ID = 3, local_train_sample_number = 865, local_test_sample_number = 10000
0 - 2025-05-21 03:51:17,424 loader.py[line:193] INFO shuffle: True, drop_last:False, train_sampler:None
0 - 2025-05-21 03:51:17,425 loader.py[line:253] INFO client_index = 3, batch_num_train_local = 14, batch_num_test_local = 157
0 - 2025-05-21 03:51:17,429 loader.py[line:246] INFO client_ID = 4, local_train_sample_number = 2731, local_test_sample_number = 10000
0 - 2025-05-21 03:51:17,429 loader.py[line:193] INFO shuffle: True, drop_last:False, train_sampler:None
0 - 2025-05-21 03:51:17,430 loader.py[line:253] INFO client_index = 4, batch_num_train_local = 43, batch_num_test_local = 157
0 - 2025-05-21 03:51:17,436 loader.py[line:246] INFO client_ID = 5, local_train_sample_number = 6130, local_test_sample_number = 10000
0 - 2025-05-21 03:51:17,436 loader.py[line:193] INFO shuffle: True, drop_last:False, train_sampler:None
0 - 2025-05-21 03:51:17,437 loader.py[line:253] INFO client_index = 5, batch_num_train_local = 96, batch_num_test_local = 157
0 - 2025-05-21 03:51:17,446 loader.py[line:246] INFO client_ID = 6, local_train_sample_number = 6415, local_test_sample_number = 10000
0 - 2025-05-21 03:51:17,447 loader.py[line:193] INFO shuffle: True, drop_last:False, train_sampler:None
0 - 2025-05-21 03:51:17,447 loader.py[line:253] INFO client_index = 6, batch_num_train_local = 101, batch_num_test_local = 157
0 - 2025-05-21 03:51:17,452 loader.py[line:246] INFO client_ID = 7, local_train_sample_number = 3034, local_test_sample_number = 10000
0 - 2025-05-21 03:51:17,452 loader.py[line:193] INFO shuffle: True, drop_last:False, train_sampler:None
0 - 2025-05-21 03:51:17,452 loader.py[line:253] INFO client_index = 7, batch_num_train_local = 48, batch_num_test_local = 157
0 - 2025-05-21 03:51:17,460 loader.py[line:246] INFO client_ID = 8, local_train_sample_number = 6091, local_test_sample_number = 10000
0 - 2025-05-21 03:51:17,460 loader.py[line:193] INFO shuffle: True, drop_last:False, train_sampler:None
0 - 2025-05-21 03:51:17,461 loader.py[line:253] INFO client_index = 8, batch_num_train_local = 96, batch_num_test_local = 157
0 - 2025-05-21 03:51:17,468 loader.py[line:246] INFO client_ID = 9, local_train_sample_number = 4479, local_test_sample_number = 10000
0 - 2025-05-21 03:51:17,468 loader.py[line:193] INFO shuffle: True, drop_last:False, train_sampler:None
0 - 2025-05-21 03:51:17,468 loader.py[line:253] INFO client_index = 9, batch_num_train_local = 70, batch_num_test_local = 157
0 - 2025-05-21 03:51:17,468 FedAVGManager.py[line:47] INFO ############setup_clients (START)#############
0 - 2025-05-21 03:51:17,610 resnet_v2.py[line:101] INFO [64, 64, 128, 256, 512]
0 - 2025-05-21 03:51:17,610 build.py[line:16] INFO model name: resnet18_v2
0 - 2025-05-21 03:51:17,610 build.py[line:34] INFO ResNet18_v2
0 - 2025-05-21 03:51:17,668 resnet_v2.py[line:101] INFO [64, 64, 128, 256, 512]
0 - 2025-05-21 03:51:17,669 ps_client_trainer.py[line:18] INFO Initializing client: 0 len(train_data) (local data num): 7615
0 - 2025-05-21 03:51:17,669 client.py[line:32] INFO client 0 VAE Moel set up
0 - 2025-05-21 03:51:17,670 client.py[line:50] INFO None
0 - 2025-05-21 03:51:17,799 resnet_v2.py[line:101] INFO [64, 64, 128, 256, 512]
0 - 2025-05-21 03:51:17,800 build.py[line:16] INFO model name: resnet18_v2
0 - 2025-05-21 03:51:17,800 build.py[line:34] INFO ResNet18_v2
0 - 2025-05-21 03:51:17,861 resnet_v2.py[line:101] INFO [64, 64, 128, 256, 512]
0 - 2025-05-21 03:51:17,862 ps_client_trainer.py[line:18] INFO Initializing client: 1 len(train_data) (local data num): 5142
0 - 2025-05-21 03:51:17,862 client.py[line:32] INFO client 1 VAE Moel set up
0 - 2025-05-21 03:51:17,862 client.py[line:50] INFO 2
0 - 2025-05-21 03:51:17,992 resnet_v2.py[line:101] INFO [64, 64, 128, 256, 512]
0 - 2025-05-21 03:51:17,992 build.py[line:16] INFO model name: resnet18_v2
0 - 2025-05-21 03:51:17,992 build.py[line:34] INFO ResNet18_v2
Files already downloaded and verified
Files already downloaded and verified
0 - 2025-05-21 03:51:18,053 resnet_v2.py[line:101] INFO [64, 64, 128, 256, 512]
0 - 2025-05-21 03:51:18,054 ps_client_trainer.py[line:18] INFO Initializing client: 2 len(train_data) (local data num): 7498
0 - 2025-05-21 03:51:18,054 client.py[line:32] INFO client 2 VAE Moel set up
0 - 2025-05-21 03:51:18,054 client.py[line:50] INFO None
0 - 2025-05-21 03:51:18,184 resnet_v2.py[line:101] INFO [64, 64, 128, 256, 512]
0 - 2025-05-21 03:51:18,184 build.py[line:16] INFO model name: resnet18_v2
0 - 2025-05-21 03:51:18,184 build.py[line:34] INFO ResNet18_v2
0 - 2025-05-21 03:51:18,245 resnet_v2.py[line:101] INFO [64, 64, 128, 256, 512]
0 - 2025-05-21 03:51:18,246 ps_client_trainer.py[line:18] INFO Initializing client: 3 len(train_data) (local data num): 865
0 - 2025-05-21 03:51:18,246 client.py[line:32] INFO client 3 VAE Moel set up
0 - 2025-05-21 03:51:18,247 client.py[line:50] INFO 1
0 - 2025-05-21 03:51:18,376 resnet_v2.py[line:101] INFO [64, 64, 128, 256, 512]
0 - 2025-05-21 03:51:18,376 build.py[line:16] INFO model name: resnet18_v2
0 - 2025-05-21 03:51:18,376 build.py[line:34] INFO ResNet18_v2
0 - 2025-05-21 03:51:18,438 resnet_v2.py[line:101] INFO [64, 64, 128, 256, 512]
0 - 2025-05-21 03:51:18,438 ps_client_trainer.py[line:18] INFO Initializing client: 4 len(train_data) (local data num): 2731
0 - 2025-05-21 03:51:18,439 client.py[line:32] INFO client 4 VAE Moel set up
0 - 2025-05-21 03:51:18,439 client.py[line:50] INFO None
0 - 2025-05-21 03:51:18,569 resnet_v2.py[line:101] INFO [64, 64, 128, 256, 512]
0 - 2025-05-21 03:51:18,569 build.py[line:16] INFO model name: resnet18_v2
0 - 2025-05-21 03:51:18,569 build.py[line:34] INFO ResNet18_v2
0 - 2025-05-21 03:51:18,630 resnet_v2.py[line:101] INFO [64, 64, 128, 256, 512]
0 - 2025-05-21 03:51:18,631 ps_client_trainer.py[line:18] INFO Initializing client: 5 len(train_data) (local data num): 6130
0 - 2025-05-21 03:51:18,631 client.py[line:32] INFO client 5 VAE Moel set up
0 - 2025-05-21 03:51:18,631 client.py[line:50] INFO None
0 - 2025-05-21 03:51:18,761 resnet_v2.py[line:101] INFO [64, 64, 128, 256, 512]
0 - 2025-05-21 03:51:18,762 build.py[line:16] INFO model name: resnet18_v2
0 - 2025-05-21 03:51:18,762 build.py[line:34] INFO ResNet18_v2
0 - 2025-05-21 03:51:18,824 resnet_v2.py[line:101] INFO [64, 64, 128, 256, 512]
0 - 2025-05-21 03:51:18,824 ps_client_trainer.py[line:18] INFO Initializing client: 6 len(train_data) (local data num): 6415
0 - 2025-05-21 03:51:18,824 client.py[line:32] INFO client 6 VAE Moel set up
0 - 2025-05-21 03:51:18,825 client.py[line:50] INFO None
0 - 2025-05-21 03:51:19,015 resnet_v2.py[line:101] INFO [64, 64, 128, 256, 512]
0 - 2025-05-21 03:51:19,015 build.py[line:16] INFO model name: resnet18_v2
0 - 2025-05-21 03:51:19,015 build.py[line:34] INFO ResNet18_v2
0 - 2025-05-21 03:51:19,076 resnet_v2.py[line:101] INFO [64, 64, 128, 256, 512]
0 - 2025-05-21 03:51:19,077 ps_client_trainer.py[line:18] INFO Initializing client: 7 len(train_data) (local data num): 3034
0 - 2025-05-21 03:51:19,077 client.py[line:32] INFO client 7 VAE Moel set up
0 - 2025-05-21 03:51:19,078 client.py[line:50] INFO None
0 - 2025-05-21 03:51:19,207 resnet_v2.py[line:101] INFO [64, 64, 128, 256, 512]
0 - 2025-05-21 03:51:19,207 build.py[line:16] INFO model name: resnet18_v2
0 - 2025-05-21 03:51:19,207 build.py[line:34] INFO ResNet18_v2
0 - 2025-05-21 03:51:19,268 resnet_v2.py[line:101] INFO [64, 64, 128, 256, 512]
0 - 2025-05-21 03:51:19,269 ps_client_trainer.py[line:18] INFO Initializing client: 8 len(train_data) (local data num): 6091
0 - 2025-05-21 03:51:19,269 client.py[line:32] INFO client 8 VAE Moel set up
0 - 2025-05-21 03:51:19,269 client.py[line:50] INFO 2
0 - 2025-05-21 03:51:19,398 resnet_v2.py[line:101] INFO [64, 64, 128, 256, 512]
0 - 2025-05-21 03:51:19,398 build.py[line:16] INFO model name: resnet18_v2
0 - 2025-05-21 03:51:19,398 build.py[line:34] INFO ResNet18_v2
0 - 2025-05-21 03:51:19,460 resnet_v2.py[line:101] INFO [64, 64, 128, 256, 512]
0 - 2025-05-21 03:51:19,461 ps_client_trainer.py[line:18] INFO Initializing client: 9 len(train_data) (local data num): 4479
0 - 2025-05-21 03:51:19,461 client.py[line:32] INFO client 9 VAE Moel set up
0 - 2025-05-21 03:51:19,461 client.py[line:50] INFO None
0 - 2025-05-21 03:51:19,461 FedAVGManager.py[line:72] INFO ############setup_clients (END)#############
0 - 2025-05-21 03:51:19,462 FedAVGManager.py[line:24] INFO ############_setup_server (START)#############
0 - 2025-05-21 03:51:19,462 build.py[line:16] INFO model name: resnet18_v2
0 - 2025-05-21 03:51:19,462 build.py[line:34] INFO ResNet18_v2
0 - 2025-05-21 03:51:19,523 resnet_v2.py[line:101] INFO [64, 64, 128, 256, 512]
0 - 2025-05-21 03:51:19,655 resnet_v2.py[line:101] INFO [64, 64, 128, 256, 512]
0 - 2025-05-21 03:51:19,657 FedAVGManager.py[line:43] INFO ############_setup_server (END)#############
0 - 2025-05-21 03:51:19,657 basePSmanager.py[line:108] INFO ############Round 0 VAE #######################
0 - 2025-05-21 03:51:19,657 basePSmanager.py[line:209] INFO VAE sampling client_indexes = [0, 1, 2, 3, 4, 5, 6, 7, 8, 9]
0 - 2025-05-21 03:51:19,657 client.py[line:336] INFO client 0 is going to train own VAE-model to generate RX GX and RXnoise
/root/FedFed/utils/set.py:246: UserWarning: This overload of add_ is deprecated:
	add_(Number alpha, Tensor other)
Consider using one of the following signatures instead:
	add_(Tensor other, *, Number alpha) (Triggered internally at  ../torch/csrc/utils/python_arg_parser.cpp:1174.)
  exp_avg.mul_(beta1).add_(1 - beta1, grad)
0 - 2025-05-21 03:51:49,026 client.py[line:242] INFO
=> Training Epoch #1, LR=0.0010
0 - 2025-05-21 03:51:59,639 client.py[line:336] INFO client 1 is going to train own VAE-model to generate RX GX and RXnoise
0 - 2025-05-21 03:52:08,068 client.py[line:242] INFO
=> Training Epoch #1, LR=0.0010
0 - 2025-05-21 03:52:13,401 client.py[line:336] INFO client 2 is going to train own VAE-model to generate RX GX and RXnoise
0 - 2025-05-21 03:52:38,428 client.py[line:242] INFO
=> Training Epoch #1, LR=0.0010
0 - 2025-05-21 03:52:48,424 client.py[line:336] INFO client 3 is going to train own VAE-model to generate RX GX and RXnoise
0 - 2025-05-21 03:52:51,424 client.py[line:242] INFO
=> Training Epoch #1, LR=0.0010
0 - 2025-05-21 03:52:52,711 client.py[line:336] INFO client 4 is going to train own VAE-model to generate RX GX and RXnoise
0 - 2025-05-21 03:53:01,719 client.py[line:242] INFO
=> Training Epoch #1, LR=0.0010
0 - 2025-05-21 03:53:05,511 client.py[line:336] INFO client 5 is going to train own VAE-model to generate RX GX and RXnoise
0 - 2025-05-21 03:53:25,514 client.py[line:242] INFO
=> Training Epoch #1, LR=0.0010
0 - 2025-05-21 03:53:33,717 client.py[line:336] INFO client 6 is going to train own VAE-model to generate RX GX and RXnoise
0 - 2025-05-21 03:53:54,629 client.py[line:242] INFO
=> Training Epoch #1, LR=0.0010
0 - 2025-05-21 03:54:03,275 client.py[line:336] INFO client 7 is going to train own VAE-model to generate RX GX and RXnoise
0 - 2025-05-21 03:54:13,424 client.py[line:242] INFO
=> Training Epoch #1, LR=0.0010
0 - 2025-05-21 03:54:17,257 client.py[line:336] INFO client 8 is going to train own VAE-model to generate RX GX and RXnoise
0 - 2025-05-21 03:54:27,220 client.py[line:242] INFO
=> Training Epoch #1, LR=0.0010
0 - 2025-05-21 03:54:33,235 client.py[line:336] INFO client 9 is going to train own VAE-model to generate RX GX and RXnoise
0 - 2025-05-21 03:54:47,933 client.py[line:242] INFO
=> Training Epoch #1, LR=0.0010
0 - 2025-05-21 03:54:55,025 basePSmanager.py[line:151] INFO initial global model using Classifier from VAE in Round 0
0 - 2025-05-21 03:54:56,931 ps_aggregator.py[line:166] INFO
| VAE Phase Server Testing Round #0		Test Acc: 10.0000 Test Loss: 2.5484
0 - 2025-05-21 03:54:56,931 basePSmanager.py[line:108] INFO ############Round 1 VAE #######################
0 - 2025-05-21 03:54:56,931 basePSmanager.py[line:209] INFO VAE sampling client_indexes = [0, 1, 2, 3, 4, 5, 6, 7, 8, 9]
0 - 2025-05-21 03:54:56,932 client.py[line:336] INFO client 0 is going to train own VAE-model to generate RX GX and RXnoise
Traceback (most recent call last):
  File "main.py", line 83, in <module>
    fedavg_manager = FedAVGManager(device, cfg)
  File "/root/FedFed/algorithms_standalone/fedavg/FedAVGManager.py", line 16, in __init__
    super().__init__(device, args)
  File "/root/FedFed/algorithms_standalone/basePS/basePSmanager.py", line 45, in __init__
    self._share_data_step()
  File "/root/FedFed/algorithms_standalone/basePS/basePSmanager.py", line 114, in _share_data_step
    client.train_vae_model(round)
  File "/root/FedFed/algorithms_standalone/basePS/client.py", line 341, in train_vae_model
    logging.info(f"client {self.client_index} is going to train own VAE-model to generate RX GX and RXnoise")
  File "/root/FedFed/algorithms_standalone/basePS/client.py", line 144, in aug_classifier_train
  File "/root/miniconda3/envs/FedFed/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 652, in __next__
    data = self._next_data()
  File "/root/miniconda3/envs/FedFed/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 692, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
  File "/root/miniconda3/envs/FedFed/lib/python3.8/site-packages/torch/utils/data/_utils/fetch.py", line 49, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "/root/miniconda3/envs/FedFed/lib/python3.8/site-packages/torch/utils/data/_utils/fetch.py", line 49, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "/root/FedFed/data_preprocessing/cifar10/datasets.py", line 214, in __getitem__
    img = self.transform(img)
  File "/root/miniconda3/envs/FedFed/lib/python3.8/site-packages/torchvision/transforms/transforms.py", line 94, in __call__
    img = t(img)
  File "/root/miniconda3/envs/FedFed/lib/python3.8/site-packages/torchvision/transforms/transforms.py", line 134, in __call__
    return F.to_tensor(pic)
  File "/root/miniconda3/envs/FedFed/lib/python3.8/site-packages/torchvision/transforms/functional.py", line 164, in to_tensor
    img = torch.from_numpy(np.array(pic, mode_to_nptype.get(pic.mode, np.uint8), copy=True))
TypeError: int() argument must be a string, a bytes-like object or a number, not 'Image'